<!doctype html>
<html lang="en">
<head>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<!--
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <script type="text/javascript" src="../js/jquery-1.11.0.min.js"></script>
    -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
	crossorigin="anonymous">

<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="../js/bootbox.min.js"></script>

<title>Animales</title>
</head>
<body>
	<div>
		<nav class="navbar navbar-dark bg-dark justify-content-end">
			<div class="dropdown">
				<a class="nav-link dropdown-toggle" href="#"
					id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown"
					aria-expanded="false"> <b><script>document.write(sessionStorage.getItem("usuario_activo"));</script></b>
				</a>
				<ul class="dropdown-menu dropdown-menu-end"
					aria-labelledby="navbarDropdownMenuLink">
					<li><a class="dropdown-item" onclick="VerPerfil()">Ver
							Perfil</a></li>
					<li><a class="dropdown-item" onclick="CerrarSesion()">Cerrar
							Sesión</a></li>
				</ul>
			</div>
		</nav>
	</div>

	<div id="NoMovil" style="display: none;">
		<div
			style="width: 150px; float: left; position: absolute; top: 50px; bottom: 0; background-color: #212529;">
			<nav class="navbar navbar-dark bg-dark">
				<ul class="navbar-nav">
					<li class="nav-item"><a class="nav-link active"
						style="padding-left: 10px; background-color: #e3e4e5; width: 150px; color: black"
						href="./Animales.html"><b>ANIMALES</b></a></li>
					<li class="nav-item"><a class="nav-link active"
						style="padding-left: 10px; width: 150px;"
						href="./Crias.html">Venta crías</a></li>
					<li class="nav-item"><a class="nav-link active"
						style="padding-left: 10px; width: 150px;"
						href="./Exportaciones.html">Exportaciones</a></li>
	                <!-- 
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Venta Ovejas</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Venta Corderos</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Muerte Ovejas</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Medicamentos</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Piensos</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Piensos Medicamentosos</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Enfermedades</a>
	                </li>
	                -->
				</ul>
			</nav>
		</div>


		<h1 style="text-align: center;">Animales</h1>

		<nav class="navbar navbar-dark bg-dark" style="margin-left: 155px">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button"
					data-bs-toggle="collapse"
					data-bs-target="#navbarToggleExternalContent"
					aria-controls="navbarToggleExternalContent" aria-expanded="false"
					aria-label="Toggle navigation">
					<span><img src="./desplegable.png" width="20" height="20"></span>
				</button>
			</div>
		</nav>
		<div class="collapse" id="navbarToggleExternalContent"
			style="margin-left: 155px">
			<div style="background-color: #A9D0F5">
				<div class="card">
					<div class="card-body" style="background-color: #A9D0F5">
						<table>
							<tr>
								<!--
			  			<td style="width:25%;">
			  				<div id="FiltroAnoNoMovil">
						  		<label style="float:left;">Hasta año de vida:</label>
							    <select class="form-select" aria-label="Default select example" id="FiltroAnoVivasNoMovil" style="width:30%;float:left;">
								  <option selected>-----</option>
								  <option value="1">2021</option>
								  <option value="2">2022</option>
								  <option value="3">2023</option>
								</select>
						  	</div>
						  	
						  	<br>
						  	<br>
						  	 
						  	<button type="button" class="btn btn-outline-light">Buscar</button>
			  			</td>
			  			-->
								<td style="width: 25%;">
									<div>
										<label style="float: left;">Año de nacimiento:</label> <select
											class="form-select" aria-label="Default select example"
											id="FiltroAnoNacNoMovil" style="width: 30%; float: left;">
											<option selected>-----</option>
											<option value="2021">2021</option>
											<option value="2022">2022</option>
											<option value="2023">2023</option>
										</select>
									</div> <br> <br>

									<button type="button" class="btn btn-outline-light"
										onClick="BuscarFiltro2()">Buscar</button>
								</td>

								<td style="width: 25%;">
									<div>
										<label style="margin-left: 1%; float: left;">Buscar
											por referencia:</label> <input type="number" class="form-control"
											style="width: 50%;" id="FiltroNumRefNoMovil">
									</div>

									<button type="button" class="btn btn-outline-light"
										onClick="BuscarFiltro3()">Buscar</button>
								</td>

								<td style="width: 25%;">
									<div class="form-check">
										<input class="form-check-input" type="checkbox" value=""
											id="CheckMuertas" style="float: left;"> <label
											class="form-check-label" for="flexCheckIndeterminate">Ovejas
											muertas</label>
									</div>

									<div class="form-check">
										<input class="form-check-input" type="checkbox" value=""
											id="CheckVendidas"> <label class="form-check-label"
											for="flexCheckIndeterminate">Ovejas vendidas</label>
									</div>

									<div>
										<label style="float: left;">Año:</label> <select
											name="FiltroAnoMVNoMovil" class="form-select"
											aria-label="Default select example" id="FiltroAnoMVNoMovil"
											style="width: 27%; float: left;">
											<option selected>-----</option>
											<option value="2021">2021</option>
											<option value="2022">2022</option>
											<option value="2023">2023</option>
										</select>
									</div>

									<button type="button" class="btn btn-outline-light"
										onClick="BuscarFiltro4()">Buscar</button>
								</td>

								<td style="width: 25%;">
									<div class="form-check">
										<img src="./anadir.png" title="Añadir animal" height="25"
											size="25" id="" style="float: left; cursor: pointer;"
											onClick="AnadirAnimal()"> <label style="float: left;">&nbsp;
											Añadir animal</label>
									</div>
									<div class="form-check">
										<img src="./excel.png" title="Sin crotal" height="25"
											size="25" id="" style="float: left; cursor: pointer;"
											onClick="DescargarSinCrotal()"> <label
											style="float: left;">&nbsp; Descargar sin crotal</label>
									</div>
									<div class="form-check">
										<img src="./excel.png" title="Sin bolo" height="25" size="25"
											id="" style="float: left; cursor: pointer;"
											onClick="DescargarSinBolo()"> <label
											style="float: left;">&nbsp; Descargar sin bolo</label>
									</div>
								</td>
							</tr>
						</table>
					</div>
				</div>
			</div>
		</div>



		<hr>

		<div id="card"></div>

		<nav aria-label="Page navigation example">
			<ul class="pagination justify-content-center" id="paginacion">
				<!-- 
		    <li class="page-item"><a class="page-link" href="#">1</a></li>
		    <li class="page-item"><a class="page-link" href="#">2</a></li>
		    <li class="page-item"><a class="page-link" href="#">3</a></li>
		     -->
			</ul>
		</nav>
	</div>

	<div id="Movil" style="display: none;">
		<div
			style="width: 60px; float: left; position: absolute; top: 50px; bottom: 0; background-color: #212529;">
			<nav class="navbar navbar-dark bg-dark">
				<ul class="navbar-nav">
					<li class="nav-item"><a class="nav-link active"
						style="padding-left: 10px;" href="./Animales.html"> <img
							src="./oveja.png" width="15" height="15" style="display: inline;">
							<img src="./cabra.png" width="15" height="15"
							style="display: inline;">
					</a></li>
					<!-- 
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Leche</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Venta Ovejas</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Venta Corderos</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Muerte Ovejas</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Medicamentos</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Piensos</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Piensos Medicamentosos</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link active" style="padding-left:10px;" href="#">Enfermedades</a>
	                </li>
	                -->
				</ul>
			</nav>
		</div>


		<h1 style="text-align: center;">Animales</h1>

		<nav class="navbar navbar-dark bg-dark" style="margin-left: 65px;">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button"
					data-bs-toggle="collapse"
					data-bs-target="#navbarToggleExternalContent"
					aria-controls="navbarToggleExternalContent" aria-expanded="false"
					aria-label="Toggle navigation">
					<span><img src="./desplegable.png" width="10" height="10"></span>
				</button>
			</div>
		</nav>
		<div class="collapse" id="navbarToggleExternalContent"
			style="margin-left: 65px; height: 10px;">
			<div style="background-color: #A9D0F5">
				<div class="card">
					<div class="card-body" style="background-color: #A9D0F5">
						<table>
							<tr>
								<!--
			  			<td style="width:25%;">
			  				<div id="FiltroAnoNoMovil">
						  		<label style="float:left;">Hasta año de vida:</label>
							    <select class="form-select" aria-label="Default select example" id="FiltroAnoVivasNoMovil" style="width:30%;float:left;">
								  <option selected>-----</option>
								  <option value="1">2021</option>
								  <option value="2">2022</option>
								  <option value="3">2023</option>
								</select>
						  	</div>
						  	
						  	<br>
						  	<br>
						  	 
						  	<button type="button" class="btn btn-outline-light">Buscar</button>
			  			</td>
			  			-->

									<div>
										<label style="float: left;">Año de nacimiento:</label> <select
											class="form-select" aria-label="Default select example"
											id="FiltroAnoNacMovil" style="width: 30%; float: left;">
											<option selected>-----</option>
											<option value="2021">2021</option>
											<option value="2022">2022</option>
											<option value="2023">2023</option>
										</select>
									</div> <br> <br>

									<button type="button" class="btn btn-outline-light"
										onClick="BuscarFiltro2()">Buscar</button>
										
									<hr>
									<div>
										<label style="margin-left: 1%; float: left;">Buscar
											por referencia:</label> <input type="number" class="form-control"
											style="width: 50%;" id="FiltroNumRefMovil">
									</div>

									<button type="button" class="btn btn-outline-light"
										onClick="BuscarFiltro3()">Buscar</button>

									<hr>
									
									<div class="form-check">
										<input class="form-check-input" type="checkbox" value=""
											id="CheckMuertasMovil" style="float: left;"> <label
											class="form-check-label" for="flexCheckIndeterminate">Ovejas
											muertas</label>
									</div>

									<div class="form-check">
										<input class="form-check-input" type="checkbox" value=""
											id="CheckVendidasMovil"> <label class="form-check-label"
											for="flexCheckIndeterminate">Ovejas vendidas</label>
									</div>

									<div>
										<label style="float: left;">Año:</label> <select
											name="FiltroAnoMVMovil" class="form-select"
											aria-label="Default select example" id="FiltroAnoMVMovil"
											style="width: 27%; float: left;">
											<option selected>-----</option>
											<option value="2021">2021</option>
											<option value="2022">2022</option>
											<option value="2023">2023</option>
										</select>
									</div>

									
									
									<button type="button" class="btn btn-outline-light"
										onClick="BuscarFiltro4()">Buscar</button>
										
									<hr>

									<div class="form-check">
										<img src="./anadir.png" title="Añadir animal" height="25"
											size="25" id="" style="float: left; cursor: pointer;"
											onClick="AnadirAnimal()"> <label style="float: left;">&nbsp;
											Añadir animal</label>
									</div>
									<div class="form-check">
										<img src="./excel.png" title="Sin crotal" height="25"
											size="25" id="" style="float: left; cursor: pointer;"
											onClick="DescargarSinCrotal()"> <label
											style="float: left;">&nbsp; Descargar sin crotal</label>
									</div>
									<div class="form-check">
										<img src="./excel.png" title="Sin bolo" height="25" size="25"
											id="" style="float: left; cursor: pointer;"
											onClick="DescargarSinBolo()"> <label
											style="float: left;">&nbsp; Descargar sin bolo</label>
									</div>

							</tr>
						</table>
					</div>
				</div>
			</div>
		</div>
		<br> <br>

		<div id="cardMovil"></div>

		<nav aria-label="Page navigation example">
			<ul class="pagination justify-content-center" id="paginacionMovil">
				<!-- 
		    <li class="page-item"><a class="page-link" href="#">1</a></li>
		    <li class="page-item"><a class="page-link" href="#">2</a></li>
		    <li class="page-item"><a class="page-link" href="#">3</a></li>
		     -->
			</ul>
		</nav>


	</div>
	<!-- Optional JavaScript; choose one of the two! -->

	<!-- Option 1: Bootstrap Bundle with Popper -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
		crossorigin="anonymous"></script>

	<!-- Option 2: Separate Popper and Bootstrap JS -->
	<!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>
    -->
</body>
</html>

<script>
$(function() {

	var usuario = sessionStorage.getItem("usuario_activo");
	
	if(usuario == null){
		sessionStorage.clear();
		var url = "./IniciarSesion.html";
	    window.location.href = url;
	}else{
	
  		//Comprobar si es telefono u ordenador
	
	    try{ 
	        document.createEvent("TouchEvent"); 
	        document.getElementById('Movil').style.display='block';
	        sessionStorage.setItem('Movil', "true");
	        var parar;
	        parar = 1;
	        return true; 
	    }
	    catch(e){ 
	    	document.getElementById('NoMovil').style.display='block';
	    	sessionStorage.setItem('Movil', "false");
	        return false;
	    }
	}
  
});
</script>

<script>
function CerrarSesion(){
	sessionStorage.clear();
	var url = "./IniciarSesion.html";
    window.location.href = url;
}
</script>

<script>
function VerPerfil(){
	//Primero hay que sacar los datos de base de datos de el usuario que se encuentra conectado
	var usuario = sessionStorage.getItem("usuario_activo");
	
	var usuarioDatos= {
		'usuario' : usuario,
	};

	var usuarioLoginJSON = JSON.stringify(usuarioDatos);

	var url = './sacardatos';

	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		data : usuarioLoginJSON,
		success : function(data, textStatus, jqXHR) {
			//Guardar las variables globales para mostrarlas en los input de Ver Perfil
			sessionStorage.setItem('Nombre', data.Nombre);
			sessionStorage.setItem('PApellido', data.PApellido);
			sessionStorage.setItem('SApellido', data.SApellido);
			sessionStorage.setItem('DNINIF', data.DNINIF);
			sessionStorage.setItem('CElectronico', data.CElectronico);
			sessionStorage.setItem('NumExplotacion', data.NumExplotacion);
			
			//Luego redirigir a la página
			var url = "./VerPerfil.html";
		    window.location.href = url;
		},
		error : function(jqXHR, exception) {
			// mostrarPantallaError(url, jqXHR);
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
	
	
}
</script>

<script>
$(function() {
	
	var usuario = sessionStorage.getItem("usuario_activo");
	
		var usuarioDatos= {
		'usuario' : usuario,
	};

	var usuarioLoginJSON = JSON.stringify(usuarioDatos);

	var url = './recogerExplotaciones';

	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		data : usuarioLoginJSON,
		success : function(data, textStatus, jqXHR) {
			var numExplotaciones = data.ListaExplotaciones;
			var size = Object.keys(numExplotaciones).length;
			
			if(size == 1){
				sessionStorage.setItem('NumeroExplotacion', data.ListaExplotaciones[0]);
				paginacion(1);
			}else{
				txt = document.getElementById("listadoExplotaciones");
				var mensaje = "";
				mensaje = mensaje + "<table>";
					mensaje = mensaje + "<tr>";	
						mensaje = mensaje + "<th style='border: 1px solid black;'>Número Explotación</th>";
						mensaje = mensaje + "<th style='border: 1px solid black;'>Tipo de animal</th>";		
					mensaje = mensaje + "</tr>";
				for(var i=0; i<size; i++){
					mensaje = mensaje + "<tr>";	
						mensaje = mensaje + "<td style='border: 1px solid black;'>" + data.ListaExplotaciones[i] + "</td>";
						mensaje = mensaje + "<td style='border: 1px solid black;'>" + data.ListaTipoAnimal[i] + "</td>";		
					mensaje = mensaje + "</tr>";
				}
				mensaje = mensaje + "</table>";
			
				bootbox.confirm({
					title:"¿Qué listado deseas ver?", 
					message: mensaje,
					onEscape: true,
					buttons: {
				        confirm: {
				            label: 'OVINO',
				            className: 'btn-primary'
				        },
				        cancel: {
				            label: 'CAPRINO',
				            className: 'btn-primary'
				        }
				    },
				    callback: function (result) {
				        if (result) {
				        	for(var i=0; i<size; i++){
								if(data.ListaTipoAnimal[i] == 'ovino'){
									sessionStorage.setItem('NumeroExplotacion', data.ListaExplotaciones[i]);
								}
							}
				        	paginacion(1);
			            } else {
			            	for(var i=0; i<size; i++){
								if(data.ListaTipoAnimal[i] == 'caprino'){
									sessionStorage.setItem('NumeroExplotacion', data.ListaExplotaciones[i]);
								}
							}
			                paginacion(1);
			            }
				    }
				});
			}
			
			
		},
		error : function(jqXHR, exception) {
			// mostrarPantallaError(url, jqXHR);
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});

});
</script>

<script>
function paginacion(NumPaginacion){

	var movil = sessionStorage.getItem("Movil");
	if(sessionStorage.getItem("Movil") == "false"){
		//Primero hay que sacar los datos de base de datos de el usuario que se encuentra conectado
		var usuario = sessionStorage.getItem("usuario_activo");
		var NumExplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		var usuarioDatos= {
			'usuario' : usuario,
			'NumExplotacion' : NumExplotacion,
		};
	
		var usuarioLoginJSON = JSON.stringify(usuarioDatos);
	
		var url = './cargarovejas';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : usuarioLoginJSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
	
				txt = document.getElementById("card");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 25;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				if(NumPaginacion == 1){
					var valor = 0;	
				}else{
					var valor = (NumPaginacion - 1) * 25;	
				}
					
				var total = (NumPaginacion * 25) + 25;
				doc = doc + '<p style="margin-left: 155px;"><em>Página '+NumPaginacion+' de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 155px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<5; x++){
									if(x==0){
										var par = 1;
									}else{
										if(x % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
								
									
									doc = doc + '<td style="width: 500px;">';
										if(par == 0){
											if(valor < total && valor < size){
												doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title"><img src="./muerte.png" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
												+ '<img src="./venta.png" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}else{
											if(valor < total && valor < size){
												doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title"><img src="./muerte.png" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
												+ '<img src="./venta.png" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}
										valor = valor + 1;
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacion");
				
				doc2 = "";
				
				for(var z=1; z<=paginacion; z++){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+z+')">' + z + '</a></li>';
				}
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}else{
		//Primero hay que sacar los datos de base de datos de el usuario que se encuentra conectado
		var usuario = sessionStorage.getItem("usuario_activo");
		var NumExplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		var usuarioDatos= {
			'usuario' : usuario,
			'NumExplotacion' : NumExplotacion,
		};
	
		var usuarioLoginJSON = JSON.stringify(usuarioDatos);
	
		var url = './cargarovejas';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : usuarioLoginJSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
	
				txt = document.getElementById("cardMovil");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 10;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				if(NumPaginacion == 1){
					var valor = 0;	
				}else{
					var valor = (NumPaginacion - 1) * 10;	
				}
					
				var total = (NumPaginacion * 10) + 10;
				doc = doc + '<p style="margin-left: 68px;"><em>Página '+NumPaginacion+' de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 68px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<2; x++){
									if(j==0){
										var par = 1;
									}else{
										if(j % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
								
									
									doc = doc + '<td style="width: 500px;">';
										if(par == 0){
											if(valor < total && valor < size){
												doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title"><img src="./muerte.png" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
												+ '<img src="./venta.png" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}else{
											if(valor < total && valor < size){
												doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title"><img src="./muerte.png" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
												+ '<img src="./venta.png" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}
										valor = valor + 1;
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacionMovil");
				
				doc2 = "";
				
				if(NumPaginacion == 1){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>';
				}else if (NumPaginacion == paginacion){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
				}else if(NumPaginacion == 2 || NumPaginacion == paginacion-1){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>';
				}else{
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(1)">' + 1 + '</a></li>...';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>...';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+paginacion+')">' + paginacion + '</a></li>';
				}
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}
  
}
</script>

<script>
function VisualizarOveja(NumIdentificacion){

	var usuarioDatos= {
		'NumIdentificacion' : NumIdentificacion,
	};

	var usuarioLoginJSON = JSON.stringify(usuarioDatos);

	var url = './visualizaroveja';
	
	
	
	var FechaBaja;
	var sexo1;
	var AnoNacimiento;
	var TieneBolo;
	var TieneCrotal;
	var NumExplotacion;
	var Venta;
	var Muerta;
	
	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		data : usuarioLoginJSON,
		success : function(data, textStatus, jqXHR) {
			
			FechaBaja = data.FechaBaja;
			sexo1 = data.Sexo;
			AnoNacimiento = data.AnoNacimiento;
			TieneBolo = data.TieneBolo;
			TieneCrotal = data.TieneCrotal;
			NumExplotacion = data.NumExplotacion;
			Muerta = data.Muerta;
			Venta = data.Venta;
			
			VentanaOveja(NumIdentificacion, FechaBaja, sexo1, AnoNacimiento, TieneBolo, TieneCrotal, NumExplotacion, Muerta, Venta);
			
		},
		error : function(jqXHR, exception) {
			// mostrarPantallaError(url, jqXHR);
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
	
	
}
</script>

<script>
function VentanaOveja(NumIdentificacion, FechaBaja, sexo1, AnoNacimiento, TieneBolo, TieneCrotal, NumExplotacion, Muerta, Venta){
	var mensaje = "";
//Comprobar si es hembra o macho
			var sexo;
			if(sexo1 == "H"){
				sexo = "Hembra";
			}else if(sexo1 == "M"){
				sexo == "Macho";
			}
			
			if(Muerta == "1"){
				mensaje = "<div class='card text-white bg-danger mb-3'>"+
							"<div class='card-body'>"+
								"<h5 class='card-title'>MUERTA</h5>"+
								"<p class='card-text'>La oveja falleció el día: " + FechaBaja + "</p>"+
							"</div>"+
						  "</div>";
			}
			
			if(Venta == "1"){
				mensaje = "<div class='card text-dark bg-warning mb-3'>"+
							"<div class='card-body'>"+
								"<h5 class='card-title'>VENDIDA</h5>"+
								"<p class='card-text'>La oveja se vendió el día: " + FechaBaja + "</p>"+
							"</div>"+
						  "</div>";
			}
			
			mensaje = mensaje + "<table>";
			
			mensaje = mensaje + "<tr>";
			mensaje = mensaje + "<td>Sexo:</td>";
			mensaje = mensaje + "<td><input id='Sexo' disabled value=" + sexo + "></td>";
			mensaje = mensaje + "</tr>";
			
			mensaje = mensaje + "<tr>";
			mensaje = mensaje + "<td>Año nacimiento:</td>";
			mensaje = mensaje + "<td><input id='AnoNacimiento' disabled value=" + AnoNacimiento + "></td>";
			mensaje = mensaje + "</tr>";
			
			if(TieneBolo == "1"){
				mensaje = mensaje + "<tr>";
				mensaje = mensaje + "<td>Tiene bolo:</td>";
				mensaje = mensaje + "<td><input type='checkbox' id='TieneBolo' name='TieneBolo' value='TieneBolo' checked disabled></td>";
				mensaje = mensaje + "</tr>";
			}else{
				mensaje = mensaje + "<tr>";
				mensaje = mensaje + "<td>Tiene bolo:</td>";
				mensaje = mensaje + "<td><input type='checkbox' id='TieneBolo' name='TieneBolo' value='TieneBolo' disabled></td>";
				mensaje = mensaje + "</tr>";
			}
			
			if(TieneCrotal == "1"){
				mensaje = mensaje + "<tr>";
				mensaje = mensaje + "<td>Tiene crotal:</td>";
				mensaje = mensaje + "<td><input type='checkbox' id='TieneCrotal' name='TieneCrotal' value='TieneCrotal' checked disabled></td>";
				mensaje = mensaje + "</tr>";
			}else{
				mensaje = mensaje + "<tr>";
				mensaje = mensaje + "<td>Tiene crotal:</td>";
				mensaje = mensaje + "<td><input type='checkbox' id='TieneCrotal' name='TieneCrotal' value='TieneCrotal' disabled></td>";
				mensaje = mensaje + "</tr>"; 
			}
			
			mensaje = mensaje + "<tr>";
			mensaje = mensaje + "<td>Número de explotación:</td>";
			mensaje = mensaje + "<td><input id='NumExplotacion' disabled value=" + NumExplotacion + "></td>";
			mensaje = mensaje + "</tr>";
			
			mensaje = mensaje + "</table>";
	
		
			if(Muerta == "1"){
				bootbox.confirm({
					title:NumIdentificacion, 
					message: mensaje,
					closeButton: true,
					onEscape: true,
					buttons: {
				        confirm: {
				            label: 'Cerrar',
				            className: 'btn-sucess'
				        }
				    },
				    callback: function (result) {
				        if (result) {
				        
			                } else {
			                
			                }
				    }
				});
			}else if(Venta == "1"){
				bootbox.confirm({
					title:NumIdentificacion, 
					message: mensaje,
					closeButton: true,
					onEscape: true,
					buttons: {
				        confirm: {
				            label: 'Cerrar',
				            className: 'btn-sucess'
				        }
				    },
				    callback: function (result) {
				        if (result) {
				        
			                } else {
			                
			                }
				    }
				});
			}else{
			
				bootbox.confirm({
					title:NumIdentificacion, 
					message: mensaje,
					closeButton: true,
					onEscape: true,
					buttons: {
				        confirm: {
				            label: 'Modificar Animal',
				            className: 'btn-danger'
				        }
				    },
				    callback: function (result) {
				        if (result) {
				        		var Sexo1 = document.getElementById("Sexo").value;
				        		var AnoNacimiento1 = document.getElementById("AnoNacimiento").value;
				        		var TieneCrotal1 = TieneCrotal;
				        		var TieneBolo1 = TieneBolo;
				        		var NumExplotacion1 = document.getElementById("NumExplotacion").value;
				        		ModificarAnimal(NumIdentificacion, Sexo1, AnoNacimiento1, TieneCrotal1, TieneBolo1, NumExplotacion1);
			                } else {
			                
			                }
				    }
				});
			}
}
</script>

<script>
function ModificarAnimal(NumIdentificacion, sexo, AnoNacimiento, TieneCrotal, TieneBolo, NumExplotacion){
	var mensaje = "";
		mensaje = mensaje + "<table>";
		
		mensaje = mensaje + "<tr>";
		mensaje = mensaje + "<td>Sexo:</td>";
		mensaje = mensaje + "<td><input id='Sexo'  value=" + sexo + "></td>";
		mensaje = mensaje + "</tr>";
		
		mensaje = mensaje + "<tr>";
		mensaje = mensaje + "<td>Año nacimiento:</td>";
		mensaje = mensaje + "<td><input id='AnoNacimiento'  value=" + AnoNacimiento + "></td>";
		mensaje = mensaje + "</tr>";
		
		if(TieneBolo == "1"){
			mensaje = mensaje + "<tr>";
			mensaje = mensaje + "<td>Tiene bolo:</td>";
			mensaje = mensaje + "<td><input type='checkbox' id='TieneBolo' name='TieneBolo' value='TieneBolo' checked ></td>";
			mensaje = mensaje + "</tr>";
		}else{
			mensaje = mensaje + "<tr>";
			mensaje = mensaje + "<td>Tiene bolo:</td>";
			mensaje = mensaje + "<td><input type='checkbox' id='TieneBolo' name='TieneBolo' value='TieneBolo' ></td>";
			mensaje = mensaje + "</tr>";
		}
		
		if(TieneCrotal == "1"){
			mensaje = mensaje + "<tr>";
			mensaje = mensaje + "<td>Tiene crotal:</td>";
			mensaje = mensaje + "<td><input type='checkbox' id='TieneCrotal' name='TieneCrotal' value='TieneCrotal' checked ></td>";
			mensaje = mensaje + "</tr>";
		}else{
			mensaje = mensaje + "<tr>";
			mensaje = mensaje + "<td>Tiene crotal:</td>";
			mensaje = mensaje + "<td><input type='checkbox' id='TieneCrotal' name='TieneCrotal' value='TieneCrotal' ></td>";
			mensaje = mensaje + "</tr>"; 
		}
		
		mensaje = mensaje + "<tr>";
		mensaje = mensaje + "<td>Número de explotación:</td>";
		mensaje = mensaje + "<td><input id='NumExplotacion' disabled value=" + NumExplotacion + "></td>";
		mensaje = mensaje + "</tr>";
		
		mensaje = mensaje + "</table>";
	
		
		bootbox.confirm({
		title:NumIdentificacion, 
		message: mensaje,
		onEscape: true,
		buttons: {
	        confirm: {
	            label: 'Confirmar Modificacion',
	            className: 'btn-danger'
	        }
	    },
	    callback: function (result) {
	        if (result) {
	        	var Sexo1 = document.getElementById("Sexo").value;
	        	if(Sexo1 == "Hembra"){
	        		sexo = "H";
	        	}else{
	        		sexo = "M";
	        	}
        		var AnoNacimiento1 = document.getElementById("AnoNacimiento").value;
        		var TieneCrotal1 = document.getElementById("TieneCrotal");
        		var TieneBolo1 = document.getElementById("TieneBolo");
        		var NumExplotacion1 = document.getElementById("NumExplotacion").value;
	        	ModificarAnimalFin(NumIdentificacion, sexo, AnoNacimiento1, TieneCrotal1, TieneBolo1, NumExplotacion1);
            } else {

            }
	    }
	});
	
}
</script>

<script>
function OvejaMuerta(NumIdentificacion){

	var mensaje = "¿Desea marcar como <b style='color:red;'> MUERTA </b> la oveja <b>" + NumIdentificacion + "</b>? </br></br>";
	
	mensaje = mensaje + "Por favor, indique los siguientes datos.";
	
	mensaje = mensaje + "<br><label> Fecha de muerte: </label>";
	mensaje = mensaje + "<input id='FechaMuerte' type='date'>";
	
	mensaje = mensaje + "<br><label> Número de documento: </label>";
	mensaje = mensaje + "<input id='NDocumento' type='text'>";  
	
	
	bootbox.confirm({
		title:NumIdentificacion, 
		message: mensaje,
		onEscape: true,
		buttons: {
	        confirm: {
	            label: 'MUERTA',
	            className: 'btn-danger'
	        }
	    },
	    callback: function (result) {
	        if (result) {
	        		var FechaMuerte = document.getElementById("FechaMuerte").value;
	        		var NDocumento = document.getElementById("NDocumento").value;
                    MarcarMuerta(NumIdentificacion, FechaMuerte, NDocumento);
                } else {
                    
                }
	    }
	});
	
	
}
</script>

<script>
function OvejaVendida(NumIdentificacion){

	var mensaje = "¿Desea marcar como <b style='color:red;'> VENDIDA </b> la oveja <b>" + NumIdentificacion + "</b>? </br></br>";
	
	mensaje = mensaje + "Por favor, indique la fecha de venta: ";
	
	mensaje = mensaje + "<br><label> Fecha de muerte: </label>";
	mensaje = mensaje + "<input id='FechaMuerte' type='date'>";
	
	mensaje = mensaje + "<br><label> Número de documento: </label>";
	mensaje = mensaje + "<input id='NDocumento' type='text'>"; 
	
	mensaje = mensaje + "<br><label> Destino: </label>";
	mensaje = mensaje + "<input id='Destino' type='text'>";
	
	bootbox.confirm({
		title:NumIdentificacion, 
		message: mensaje,
		onEscape: true,
		buttons: {
	        confirm: {
	            label: 'VENDIDA',
	            className: 'btn-danger'
	        }
	    },
	    callback: function (result) {
	        if (result) {
	        		var FechaMuerte = document.getElementById("FechaMuerte").value;
	        		var NDocumento = document.getElementById("NDocumento").value;
	        		var Destino = document.getElementById("Destino").value;
                    MarcarVenta(NumIdentificacion, FechaMuerte, NDocumento, Destino);
                } else {
                    
                }
	    }
	});
	
	
}
</script>

<script>
function MarcarMuerta(NumIdentificacion, FechaMuerte, NDocumento){

	
	var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
	
	var datosOvejaMuerta= {
		'NumIdentificacion' : NumIdentificacion,
		'FechaMuerte': FechaMuerte,
		'NDocumento': NDocumento,
		'NumExplotacion': numexplotacion
	};

	var datosOvejaMuertaJSON = JSON.stringify(datosOvejaMuerta);

	var url = './marcarmuerta';

	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		data : datosOvejaMuertaJSON,
		success : function(data, textStatus, jqXHR) {
			var resultado = data.QueryOk;
			
			if(resultado == 'correcto'){
				bootbox.confirm({
					title: NumIdentificacion, 
					message: 'Se ha marcado la oveja como MUERTA con la fecha' + FechaMuerte,
					onEscape: true,
					buttons: {
				        confirm: {
				            label: 'Aceptar',
				            className: 'btn-success'
				        }
				    },
				    callback: function (result) {
				        
				    }
				});
			}else{
				bootbox.confirm({
					title: NumIdentificacion, 
					message: 'ERROR al marcar la oveja como MUERTA, por favor, vuelva a intentarlo.',
					onEscape: true,
					buttons: {
				        confirm: {
				            label: 'Aceptar',
				            className: 'btn-danger'
				        }
				    },
				    callback: function (result) {
				        
				    }
				});
			}
		},
		error : function(jqXHR, exception) {
			// mostrarPantallaError(url, jqXHR);
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
	
}
</script>

<script>
function MarcarVenta(NumIdentificacion, FechaVenta, NDocumento, Destino){

	var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
	
	var datosOvejaVenta= {
		'NumIdentificacion' : NumIdentificacion,
		'FechaVenta': FechaVenta,
		'NDocumento': NDocumento,
		'NumExplotacion': numexplotacion,
		'ProcDestino' : Destino,
	};


	var datosOvejaVentaJSON = JSON.stringify(datosOvejaVenta);

	var url = './marcarventa';

	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		data : datosOvejaVentaJSON,
		success : function(data, textStatus, jqXHR) {
			var resultado = data.QueryOk;
			
			if(resultado == 'correcto'){
				bootbox.confirm({
					title: NumIdentificacion, 
					message: 'Se ha marcado la oveja como VENDIDA con la fecha' + FechaVenta,
					onEscape: true,
					buttons: {
				        confirm: {
				            label: 'Aceptar',
				            className: 'btn-success'
				        }
				    },
				    callback: function (result) {
				        
				    }
				});
			}else{
				bootbox.confirm({
					title: NumIdentificacion, 
					message: 'ERROR al marcar la oveja como VENDIDA, por favor, vuelva a intentarlo.',
					onEscape: true,
					buttons: {
				        confirm: {
				            label: 'Aceptar',
				            className: 'btn-danger'
				        }
				    },
				    callback: function (result) {
				        
				    }
				});
			}
		},
		error : function(jqXHR, exception) {
			// mostrarPantallaError(url, jqXHR);
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
	
}
</script>


<script>
function BuscarFiltro4(){
	//Buscar apartado 4 (ovejas muertas, ovejas vivas, año)
	
	var movil = sessionStorage.getItem("Movil");
	if(sessionStorage.getItem("Movil") == "false"){
		var checkVendida = document.getElementById("CheckVendidas");
		var checkMuerta = document.getElementById("CheckMuertas");
		var ano = $('#FiltroAnoMVNoMovil').find('option:selected').val();
		var usuario = sessionStorage.getItem("usuario_activo");
		var numExplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		if(ano == "-----" && checkVendida.checked == false && checkMuerta.checked == false){
		bootbox.dialog({
					title:'ERROR', 
					message: 'Añade un año de búsqueda y al menos un check',
					closeButton: true,
					onEscape: true
				});
		}else if(ano == "-----"){
			bootbox.dialog({
					title:'ERROR', 
					message: 'Añade un año de búsqueda y vuelve a intentarlo.',
					closeButton: true,
					onEscape: true
				});
		}else if(checkVendida.checked == false && checkMuerta.checked == false){
			bootbox.dialog({
					title:'ERROR', 
					message: 'Indica al menos un check.',
					closeButton: true,
					onEscape: true
				});
		}else{
			ano = ano + '-01-01';
		}
		
		if(checkVendida.checked == true){
			var vendida = 1;
		}else{
			var vendida = 0;
		}
		
		if(checkMuerta.checked == true){
			var muerta = 1;
		}else{
			var muerta = 0;
		}
		
		//FechaMuerte se utiliza para el filtro del año, tanto para vendidas como para muertas
		var datosFiltro4= {
			'Usuario' : usuario,
			'Muerta' : muerta,
			'Venta': vendida,
			'FechaMuerte' : ano,
			'NumExplotacion' : numExplotacion,
		};
	
		var datosFiltro4JSON = JSON.stringify(datosFiltro4);
	
		var url = './filtro4';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : datosFiltro4JSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
				
				txt = document.getElementById("card");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 25;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				var valor = -1;		
				
				doc = doc + '<p style="margin-left: 155px;"><em>Página 1 de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 155px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<5; x++){
									
									if(x==0){
										var par = 1;
									}else{
										if(x % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
									
									valor = valor + 1;
									doc = doc + '<td style="width: 500px;">';
										if(par == 0){
											if(valor < 25 && valor < size){
												doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title">'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}else{
											if(valor < 25 && valor < size){
												doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title">'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacion");
				
				doc2 = "";
				
				for(var z=1; z<=paginacion; z++){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacionFiltro4('+z+')">' + z + '</a></li>';
				}
				
				
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}else{
		var checkVendida = document.getElementById("CheckVendidasMovil");
		var checkMuerta = document.getElementById("CheckMuertasMovil");
		var ano = $('#FiltroAnoMVMovil').find('option:selected').val();
		var usuario = sessionStorage.getItem("usuario_activo");
		var numExplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		if(ano == "-----" && checkVendida.checked == false && checkMuerta.checked == false){
		bootbox.dialog({
					title:'ERROR', 
					message: 'Añade un año de búsqueda y al menos un check',
					closeButton: true,
					onEscape: true
				});
		}else if(ano == "-----"){
			bootbox.dialog({
					title:'ERROR', 
					message: 'Añade un año de búsqueda y vuelve a intentarlo.',
					closeButton: true,
					onEscape: true
				});
		}else if(checkVendida.checked == false && checkMuerta.checked == false){
			bootbox.dialog({
					title:'ERROR', 
					message: 'Indica al menos un check.',
					closeButton: true,
					onEscape: true
				});
		}else{
			ano = ano + '-01-01';
		}
		
		if(checkVendida.checked == true){
			var vendida = 1;
		}else{
			var vendida = 0;
		}
		
		if(checkMuerta.checked == true){
			var muerta = 1;
		}else{
			var muerta = 0;
		}
		
		//FechaMuerte se utiliza para el filtro del año, tanto para vendidas como para muertas
		var datosFiltro4= {
			'Usuario' : usuario,
			'Muerta' : muerta,
			'Venta': vendida,
			'FechaMuerte' : ano,
			'NumExplotacion' : numExplotacion,
		};
	
		var datosFiltro4JSON = JSON.stringify(datosFiltro4);
	
		var url = './filtro4';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : datosFiltro4JSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
				
				txt = document.getElementById("cardMovil");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 10;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				var valor = -1;		
				
				doc = doc + '<p style="margin-left: 68px;"><em>Página 1 de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 68px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<2; x++){
									
									if(j==0){
										var par = 1;
									}else{
										if(j % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
									
									valor = valor + 1;
									doc = doc + '<td style="width: 500px;">';
										if(par == 0){
											if(valor < 10 && valor < size){
												doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title">'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}else{
											if(valor < 10 && valor < size){
												doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title">'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacionMovil");
				
				doc2 = "";
				
				if(paginacion > 1){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(1)">1</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(2)">2</a></li>';
				}else{
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(1)">1</a></li>';
				}	
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}
	
	
	
	
}
</script>

<script>
function paginacionFiltro4(NumPaginacion){
	var movil = sessionStorage.getItem("Movil");
	if(sessionStorage.getItem("Movil") == "false"){
		var checkVendida = document.getElementById("CheckVendidasMovil");
		var checkMuerta = document.getElementById("CheckMuertasMovil");
		var ano = $('#FiltroAnoMVMovil').find('option:selected').val();
		var usuario = sessionStorage.getItem("usuario_activo");
		var numExplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		ano = ano + '-01-01';
		
		if(checkVendida.checked == true){
			var vendida = 1;
		}else{
			var vendida = 0;
		}
		
		if(checkMuerta.checked == true){
			var muerta = 1;
		}else{
			var muerta = 0;
		}
		
		
		//FechaMuerte se utiliza para el filtro del año, tanto para vendidas como para muertas
		var datosFiltro4= {
			'Usuario' : usuario,
			'Muerta' : muerta,
			'Venta': vendida,
			'FechaMuerte' : ano,
			'NumExplotacion' : numexplotacion,
		};
	
		var datosFiltro4JSON = JSON.stringify(datosFiltro4);
	
		var url = './filtro4';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : datosFiltro4JSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
	
				txt = document.getElementById("card");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 10;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				if(NumPaginacion == 1){
					var valor = 0;	
				}else{
					var valor = (NumPaginacion - 1) * 10;	
				}
					
				var total = (NumPaginacion * 10) + 10;
				doc = doc + '<p style="margin-left: 68px;"><em>Página '+NumPaginacion+' de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 68px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<5; x++){
									if(j==0){
										var par = 1;
									}else{
										if(j % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
								
									
									doc = doc + '<td style="width: 500px;">';
										if(par == 0){
											if(valor < total && valor < size){
												doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title">'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}else{
											if(valor < total && valor < size){
												doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title">'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}
									valor = valor + 1;	
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacion");
				
				doc2 = "";
				
				for(var z=1; z<=paginacion; z++){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacionFiltro4('+z+')">' + z + '</a></li>';
				}
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}else{
		 ///Buscar apartado 4 (ovejas muertas, ovejas vivas, año)
		var checkVendida = document.getElementById("CheckVendidas");
		var checkMuerta = document.getElementById("CheckMuertas");
		var ano = $('#FiltroAnoMVNoMovil').find('option:selected').val();
		var usuario = sessionStorage.getItem("usuario_activo");
		var numexplotacion = sessionStorage.getItem("NumeroExplotacion");4
		
		ano = ano + '-01-01';
		
		if(checkVendida.checked == true){
			var vendida = 1;
		}else{
			var vendida = 0;
		}
		
		if(checkMuerta.checked == true){
			var muerta = 1;
		}else{
			var muerta = 0;
		}
		
		
		//FechaMuerte se utiliza para el filtro del año, tanto para vendidas como para muertas
		var datosFiltro4= {
			'Usuario' : usuario,
			'Muerta' : muerta,
			'Venta': vendida,
			'FechaMuerte' : ano,
			'NumExplotacion' : numexplotacion,
		};
	
		var datosFiltro4JSON = JSON.stringify(datosFiltro4);
	
		var url = './filtro4';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : datosFiltro4JSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
	
				txt = document.getElementById("card");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 25;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				if(NumPaginacion == 1){
					var valor = 0;	
				}else{
					var valor = (NumPaginacion - 1) * 25;	
				}
					
				var total = (NumPaginacion * 25) + 25;
				doc = doc + '<p style="margin-left: 155px;"><em>Página '+NumPaginacion+' de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 155px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<5; x++){
									if(x==0){
										var par = 1;
									}else{
										if(x % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
								
									
									doc = doc + '<td style="width: 500px;">';
										if(par == 0){
											if(valor < total && valor < size){
												doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title">'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}else{
											if(valor < total && valor < size){
												doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
												+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
												+'</h5><h5 class="card-title">'
												+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
											}
										}
									valor = valor + 1;	
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacion");
				
				doc2 = "";
				
				if(NumPaginacion == 1){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>';
				}else if (NumPaginacion == paginacion){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
				}else if(NumPaginacion == 2 || NumPaginacion == paginacion-1){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>';
				}else{
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(1)">' + 1 + '</a></li>...';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>...';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+paginacion+')">' + paginacion + '</a></li>';
				}
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}
 
}
</script>

<script>
function BuscarFiltro2(){

	var movil = sessionStorage.getItem("Movil");
	if(sessionStorage.getItem("Movil") == "false"){
		//Buscar apartado 2 (año de nacimiento)
		var ano = $('#FiltroAnoNacNoMovil').find('option:selected').val();
		var usuario = sessionStorage.getItem("usuario_activo");
		var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		var datosFiltro2= {
			'Usuario' : usuario,
			'AnoNacimiento' : ano,
			'NumExplotacion' : numexplotacion,
		};
	
		var datosFiltro2JSON = JSON.stringify(datosFiltro2);
	
		var url = './filtro2';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : datosFiltro2JSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
				
				txt = document.getElementById("card");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 25;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				var valor = -1;		
				
				doc = doc + '<p style="margin-left: 155px;"><em>Página 1 de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 155px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<5; x++){
									
									if(x==0){
										var par = 1;
									}else{
										if(x % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
									
									valor = valor + 1;
									doc = doc + '<td style="width: 500px;">';
										if(par == 0){
											if(data.ListaOvejas2[valor] == "1" || data.ListaOvejas3[valor] == "1"){
												if(valor < 25 && valor < size){
													doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title">'
													+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}else{
												if(valor < 25 && valor < size){
													doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title"><img src="./muerte.png" title="Marcar como muerta" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
													+ '<img src="./venta.png" title="Marcar como vendida" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
													+'&nbsp;<img src="./ver.png" title="Ver animal" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}
										}else{
											if(data.ListaOvejas2[valor] == "1"  || data.ListaOvejas3[valor] == "1"){
												if(valor < 25 && valor < size){
													doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title">'
													+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}else{
												if(valor < 25 && valor < size){
													doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title"><img src="./muerte.png" title="Marcar como muerta" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
													+ '<img src="./venta.png" title="Marcar como vendida" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
													+'&nbsp;<img src="./ver.png" title="Ver animal" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}
											
										}
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacion");
				
				doc2 = "";
				
				for(var z=1; z<=paginacion; z++){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacionFiltro2('+z+')">' + z + '</a></li>';
				}
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}else{
	
		//Buscar apartado 2 (año de nacimiento)
		var ano = $('#FiltroAnoNacMovil').find('option:selected').val();
		var usuario = sessionStorage.getItem("usuario_activo");
		var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		var datosFiltro2= {
			'Usuario' : usuario,
			'AnoNacimiento' : ano,
			'NumExplotacion' : numexplotacion,
		};
	
		var datosFiltro2JSON = JSON.stringify(datosFiltro2);
	
		var url = './filtro2';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : datosFiltro2JSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
				
				txt = document.getElementById("cardMovil");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 10;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				var valor = -1;		
				
				doc = doc + '<p style="margin-left: 68px;"><em>Página 1 de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 68px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<2; x++){
									
									if(j==0){
										var par = 1;
									}else{
										if(j % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
									
									valor = valor + 1;
									doc = doc + '<td style="width: 500px;">';
										if(par == 0){
											if(data.ListaOvejas2[valor] == "1" || data.ListaOvejas3[valor] == "1"){
												if(valor < 10 && valor < size){
													doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title">'
													+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}else{
												if(valor < 10 && valor < size){
													doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title"><img src="./muerte.png" title="Marcar como muerta" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
													+ '<img src="./venta.png" title="Marcar como vendida" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
													+'&nbsp;<img src="./ver.png" title="Ver animal" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}
										}else{
											if(data.ListaOvejas2[valor] == "1"  || data.ListaOvejas3[valor] == "1"){
												if(valor < 10 && valor < size){
													doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title">'
													+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}else{
												if(valor < 10 && valor < size){
													doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title"><img src="./muerte.png" title="Marcar como muerta" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
													+ '<img src="./venta.png" title="Marcar como vendida" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
													+'&nbsp;<img src="./ver.png" title="Ver animal" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}
											
										}
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacionMovil");
				
				doc2 = "";
				
				if(paginacion > 1){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(1)">1</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(2)">2</a></li>';
				}else{
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(1)">1</a></li>';
				}		
				
				
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}
	
	
}
</script>

<script>
function paginacionFiltro2(NumPaginacion){
	
	var movil = sessionStorage.getItem("Movil");
	if(movil == "false"){
		//Buscar apartado 2 (año de nacimiento)
		var ano = $('#FiltroAnoNacNoMovil').find('option:selected').val();
		var usuario = sessionStorage.getItem("usuario_activo");
		var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		var datosFiltro2= {
			'Usuario' : usuario,
			'AnoNacimiento' : ano,
			'NumExplotacion' : numexplotacion,
		};
	
		var datosFiltro2JSON = JSON.stringify(datosFiltro2);
	
		var url = './filtro2';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : datosFiltro2JSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
	
				txt = document.getElementById("card");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 25;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				if(NumPaginacion == 1){
					var valor = 0;	
				}else{
					var valor = (NumPaginacion - 1) * 25;	
				}
					
				var total = (NumPaginacion * 25) + 25;
				doc = doc + '<p style="margin-left: 155px;"><em>Página '+NumPaginacion+' de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 155px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<5; x++){
									if(x==0){
										var par = 1;
									}else{
										if(x % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
								
									
									doc = doc + '<td style="width: 500px;">';
									if(par == 0){
											if(data.ListaOvejas2[valor] == "1" || data.ListaOvejas3[valor] == "1"){
												if(valor < total && valor < size){
													doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title">'
													+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}else{
												if(valor < total && valor < size){
													doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title"><img src="./muerte.png" title="Marcar como muerta" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
													+ '<img src="./venta.png" title="Marcar como vendida" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
													+'&nbsp;<img src="./ver.png" title="Ver animal" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}
										}else{
											if(data.ListaOvejas2[valor] == "1"  || data.ListaOvejas3[valor] == "1"){
												if(valor < total && valor < size){
													doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title">'
													+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}else{
												if(valor < total && valor < size){
													doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title"><img src="./muerte.png" title="Marcar como muerta" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
													+ '<img src="./venta.png" title="Marcar como vendida" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
													+'&nbsp;<img src="./ver.png" title="Ver animal" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}
											
										}
										valor = valor + 1;
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacion");
				
				doc2 = "";
				
				for(var z=1; z<=paginacion; z++){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacionFiltro2('+z+')">' + z + '</a></li>';
				}
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}else{
		//Buscar apartado 2 (año de nacimiento)
		var ano = $('#FiltroAnoNacMovil').find('option:selected').val();
		var usuario = sessionStorage.getItem("usuario_activo");
		var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
		
		var datosFiltro2= {
			'Usuario' : usuario,
			'AnoNacimiento' : ano,
			'NumExplotacion' : numexplotacion,
		};
	
		var datosFiltro2JSON = JSON.stringify(datosFiltro2);
	
		var url = './filtro2';
	
		$.ajax({
			type : 'post',
			url : url,
			contentType : 'application/json',
			dataType : 'json',
			data : datosFiltro2JSON,
			success : function(data, textStatus, jqXHR) {
				var ovejas = data.ListaOvejas;
				var size = Object.keys(ovejas).length;
	
				txt = document.getElementById("cardMovil");
				var doc = "";
				
				//Sacar el número de paginaciones que va a haber de animales.
				var paginacion = size / 10;
				
				if(Number.isInteger(paginacion)){
					paginacion = paginacion;
				}else{
					paginacion = parseInt(paginacion, 10);
					paginacion = paginacion + 1;
				}
				
				if(NumPaginacion == 1){
					var valor = 0;	
				}else{
					var valor = (NumPaginacion - 1) * 10;	
				}
					
				var total = (NumPaginacion * 10) + 10;
				doc = doc + '<p style="margin-left: 68px;"><em>Página '+NumPaginacion+' de '+paginacion+'</em></p>';
				//for(var i=1; i<=paginacion; i++){
					doc = doc + '<table style="margin-left: 68px;">';
						for(var j=0; j<5; j++){
							doc = doc + '<tr style="width: 100%">';
								for(var x=0; x<5; x++){
									if(j==0){
										var par = 1;
									}else{
										if(j % 2 == 0) {
											var par = 1;
										}else{
											var par = 0;
										}
									}
								
									
									doc = doc + '<td style="width: 500px;">';
									if(par == 0){
											if(data.ListaOvejas2[valor] == "1" || data.ListaOvejas3[valor] == "1"){
												if(valor < total && valor < size){
													doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title">'
													+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}else{
												if(valor < total && valor < size){
													doc= doc + '<div class="card text-white bg-info mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title"><img src="./muerte.png" title="Marcar como muerta" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
													+ '<img src="./venta.png" title="Marcar como vendida" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
													+'&nbsp;<img src="./ver.png" title="Ver animal" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}
										}else{
											if(data.ListaOvejas2[valor] == "1"  || data.ListaOvejas3[valor] == "1"){
												if(valor < total && valor < size){
													doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title">'
													+'&nbsp;<img src="./ver.png" height="30" size="30" id="" style="cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}else{
												if(valor < total && valor < size){
													doc= doc + '<div class="card text-white bg-primary mb-3" style="cursor:pointer;">'
													+'<div class="card-header" style="text-align:center;margin-top:5px;"><h5>'+ovejas[valor].substring(8,15)+' '
													+'</h5><h5 class="card-title"><img src="./muerte.png" title="Marcar como muerta" height="30" size="30" id="" style="float:right;cursor:pointer;" onClick="OvejaMuerta('+ovejas[valor]+')">&nbsp;'
													+ '<img src="./venta.png" title="Marcar como vendida" height="30" size="30" id="" style="cursor:pointer;" onClick="OvejaVendida('+ovejas[valor]+')">&nbsp;'
													+'&nbsp;<img src="./ver.png" title="Ver animal" height="30" size="30" id="" style="float:left;cursor:pointer;"  onClick="VisualizarOveja('+ovejas[valor]+')"> </h5></div></div>';
												}
											}
											
										}
										valor = valor + 1;
									doc = doc + '</td>';
								}
							doc = doc + '</tr>';
						}
					doc = doc + '</table>';
				//}
				
				txt.innerHTML = doc;
				
				txt2 = document.getElementById("paginacionMovil");
				
				doc2 = "";
				
				if(NumPaginacion == 1){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>';
				}else if (NumPaginacion == paginacion){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
				}else if(NumPaginacion == 2 || NumPaginacion == paginacion-1){
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>';
				}else{
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion(1)">' + 1 + '</a></li>...';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion-1)+')">' + (NumPaginacion-1) + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+NumPaginacion+')">' + NumPaginacion + '</a></li>';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+(NumPaginacion+1)+')">' + (NumPaginacion+1) + '</a></li>...';
					doc2 = doc2 + '<li class="page-item"><a class="page-link" onClick="paginacion('+paginacion+')">' + paginacion + '</a></li>';
				}
				
				txt2.innerHTML = doc2;
			},
			error : function(jqXHR, exception) {
				// mostrarPantallaError(url, jqXHR);
			},
			statuscode : {
				404 : function() {
					//mostrarPantallaError(url);
				}
			}
		});
	}
  
}
</script>

<script>
function BuscarFiltro3(){

	var movil = sessionStorage.getItem("Movil");
	if(sessionStorage.getItem("Movil") == "false"){
		var NumReferencia = document.getElementById("FiltroNumRefNoMovil").value;
	}else{
		var NumReferencia = document.getElementById("FiltroNumRefMovil").value;
	}
	//Buscar apartado 3 (número de referencia)
	
	var usuario = sessionStorage.getItem("usuario_activo");
	var numexplotacion = sessionStorage.getItem("NumeroExplotacion");

	NumReferencia = '72408000' + NumReferencia;
	
	var datosFiltro3= {
		'Usuario' : usuario,
		'NumIdentificacion' : NumReferencia,
		'NumExplotacion' : numexplotacion,
	};

	var datosFiltro3JSON = JSON.stringify(datosFiltro3);

	var url = './filtro3';
	
	var FechaBaja;
	var sexo1;
	var AnoNacimiento;
	var TieneBolo;
	var TieneCrotal;
	var NumExplotacion;
	var Venta;
	var Muerta;

	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		data : datosFiltro3JSON,
		success : function(data, textStatus, jqXHR) {
			FechaBaja = data.FechaBaja;
			sexo1 = data.Sexo;
			AnoNacimiento = data.AnoNacimiento;
			TieneBolo = data.TieneBolo;
			TieneCrotal = data.TieneCrotal;
			NumExplotacion = data.NumExplotacion;
			Muerta = data.Muerta;
			Venta = data.Venta;
			
			VentanaOveja(NumReferencia, FechaBaja, sexo1, AnoNacimiento, TieneBolo, TieneCrotal, NumExplotacion, Muerta, Venta);
			
		},
		error : function(jqXHR, exception) {
			// mostrarPantallaError(url, jqXHR);
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
	
}
</script>

<script>
function AnadirAnimal(){

	var mensaje = "";
	
	mensaje = mensaje + "<table>";
	
	mensaje = mensaje + "<tr>";
	mensaje = mensaje + "<td>Número identificación:</td>";
	mensaje = mensaje + "<td><input id='NumIdentificacion'><p style='font-size:12px;color:red;'>Últimos 7 dígitos</p></td>";
	mensaje = mensaje + "</tr>";
	
	mensaje = mensaje + "<tr>";
	mensaje = mensaje + "<td>Sexo:</td>";
	mensaje = mensaje + "<td><select id='Sexo'>" +
						"<option value='H' selected>Hembra</option>" +
						"<option value='M'>Macho</option></select></td>";
	mensaje = mensaje + "</tr>";
	
	mensaje = mensaje + "<tr>";
	mensaje = mensaje + "<td>Año nacimiento:</td>";
	mensaje = mensaje + "<td><select id='AnoNacimiento'>" +
						"<option value='2021' selected>2021</option>" +
						"<option value='2022'>2022</option>" +
						"<option value='2023'>2023</option> </select></td>";
	mensaje = mensaje + "</tr>";
	

	mensaje = mensaje + "<tr>";
	mensaje = mensaje + "<td>Tiene bolo:</td>";
	mensaje = mensaje + "<td><input type='checkbox' id='TieneBolo' name='TieneBolo' value='TieneBolo' ></td>";
	mensaje = mensaje + "</tr>";

	mensaje = mensaje + "<tr>";
	mensaje = mensaje + "<td>Tiene crotal:</td>";
	mensaje = mensaje + "<td><input type='checkbox' id='TieneCrotal' name='TieneCrotal' value='TieneCrotal'></td>";
	mensaje = mensaje + "</tr>"; 
	
	mensaje = mensaje + "<tr>";
	mensaje = mensaje + "<td>Destino:</td>";
	mensaje = mensaje + "<td><input id='Destino'></td>";
	mensaje = mensaje + "</tr>";
	
	mensaje = mensaje + "<tr>";
	mensaje = mensaje + "<td> Fecha alta: </td>";
	mensaje = mensaje + "<td><input id='FechaAlta' type='date'></td>";
	mensaje = mensaje + "</tr>";
	
	mensaje = mensaje + "</table>";
	
	bootbox.confirm({
		title:"Nuevo animal", 
		message: mensaje,
		onEscape: true,
		buttons: {
	        confirm: {
	            label: 'CONFIRMAR',
	            className: 'btn-success'
	        }
	    },
	    callback: function (result) {
	        if (result) {
	        	var numidentificacion = document.getElementById("NumIdentificacion").value;
	        	numidentificacion = '72408000' + numidentificacion;
            	var sexo = document.getElementById("Sexo").value;
            	var anonacimiento = document.getElementById("AnoNacimiento").value;
            	var tienebolo = document.getElementById("TieneBolo");
            	var valor_tienebolo = tienebolo.checked;
            	var tienecrotal = document.getElementById("TieneCrotal");
            	var valor_tienecrotal = tienecrotal.checked;
            	var ProcDes = document.getElementById("Destino").value;
            	var fechaAlta= document.getElementById("FechaAlta").value;
            	GuardarAnimal(numidentificacion, sexo, anonacimiento, valor_tienebolo, valor_tienecrotal, ProcDes, fechaAlta);
            } else {
                
            }
	    }
	});
	
}
</script>

<script>
function GuardarAnimal(numidentificacion, sexo, anonacimiento, valor_tienebolo, valor_tienecrotal, ProcDes, fechaAlta){
	var usuario = sessionStorage.getItem("usuario_activo");
	var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
	
	var datosNuevoAnimal= {
		'Usuario' : usuario,
		'NumIdentificacion' : numidentificacion,
		'Sexo' : sexo, 
		'AnoNacimiento' : anonacimiento,
		'TieneBolo' : valor_tienebolo,
		'TieneCrotal': valor_tienecrotal,
		'NumExplotacion' : numexplotacion,
		'ProcDestino' : ProcDes,
		'FechaBaja' : fechaAlta,
	};

	var datosNuevoAnimalJSON = JSON.stringify(datosNuevoAnimal);

	var url = './nuevoanimal';

	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		data : datosNuevoAnimalJSON,
		success : function(data, textStatus, jqXHR) {
			var estado = data.QueryOk;
			
			if(estado == 'correcto'){
				bootbox.dialog({
					title:numidentificacion, 
					message: "Se ha añadido el animal indicado correctamente",
					closeButton: true,
					onEscape: true
				});
			}else if(estado == 'incorrecto'){
				bootbox.dialog({
					title:"ERROR", 
					message: "NO se ha podido añadir el animal indicado",
					closeButton: true,
					onEscape: true
				});
			}
		},
		error : function(jqXHR, exception) {
			bootbox.dialog({
					title:"ERROR", 
					message: "NO se ha podido añadir el animal indicado",
					closeButton: true,
					onEscape: true
				});
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
}
</script>

<script>
function ModificarAnimalFin(numidentificacion, sexo, anonacimiento, valor_tienebolo, valor_tienecrotal){
	var usuario = sessionStorage.getItem("usuario_activo");
	var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
	
	var datosModificarAnimal= {
		'Usuario' : usuario,
		'NumIdentificacion' : numidentificacion,
		'Sexo' : sexo, 
		'AnoNacimiento' : anonacimiento,
		'TieneBolo' : valor_tienebolo.checked,
		'TieneCrotal': valor_tienecrotal.checked,
		'NumExplotacion' : numexplotacion,
	};

	var datosModificarAnimalJSON = JSON.stringify(datosModificarAnimal);

	var url = './modificaranimal';

	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		data : datosModificarAnimalJSON,
		success : function(data, textStatus, jqXHR) {
			var estado = data.QueryOk;
			
			if(estado == 'correcto'){
				bootbox.dialog({
					title:numidentificacion, 
					message: "Se ha modificado el animal indicado correctamente",
					closeButton: true,
					onEscape: true
				});
			}else if(estado == 'incorrecto'){
				bootbox.dialog({
					title:"ERROR", 
					message: "NO se ha podido modificar el animal indicado",
					closeButton: true,
					onEscape: true
				});
			}
		},
		error : function(jqXHR, exception) {
			bootbox.dialog({
					title:"ERROR", 
					message: "NO se ha podido añadir el animal indicado",
					closeButton: true,
					onEscape: true
				});
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
}
</script>

<script>
function DescargarSinCrotal (){
	

	var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
	
	/*var datosSinCrotal= {
		'NumExplotacion' : numexplotacion,
	};

	var datosSinCrotalJSON = JSON.stringify(datosSinCrotal);*/
	
	var url = './exportarSinCrotal/'+numexplotacion;
	
	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		//data : datosSinCrotalJSON,
		success : function(data, textStatus, jqXHR) {
			//var fich = JSON.parse(data);
			exportarTarifas(data.exported);
		},
		error : function(jqXHR, exception) {
			
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
}
</script>

<script>
function DescargarSinBolo (){
	

	var numexplotacion = sessionStorage.getItem("NumeroExplotacion");
	
	/*var datosSinCrotal= {
		'NumExplotacion' : numexplotacion,
	};

	var datosSinCrotalJSON = JSON.stringify(datosSinBolo);*/
	
	var url = './exportarSinBolo/'+numexplotacion;
	
	$.ajax({
		type : 'post',
		url : url,
		contentType : 'application/json',
		dataType : 'json',
		//data : datosSinCrotalJSON,
		success : function(data, textStatus, jqXHR) {
			//var fich = JSON.parse(data);
			exportarTarifas(data.exported);
		},
		error : function(jqXHR, exception) {
			
		},
		statuscode : {
			404 : function() {
				//mostrarPantallaError(url);
			}
		}
	});
}
</script>

<script>
function exportarTarifas(param){
	//Contiene la Ruta del fichero que se va a exportar 
	
	var url = '/exportarExcel/'+param;
	//mostrarPantallaCarga();
	$.ajax({
        type: 'GET',
        url: url,
        contentType: 'application/pdf',
		success: function(data,textStatus,jqXHR){
			jQuery('<form action="' + url + '" method="get"></form>').appendTo('body').submit().remove();
		},error: function(jqXHR,exception) {
			bootbox.alert({
				title: "Gestión de Tarifas",
				message: "Error en la descarga de tarifas.",
				buttons: {
					ok: {
						label: 'Aceptar',
						className: 'btn btn-primary'
					},
				},
			});
			//document.getElementById('ficheroImportacion').disabled=true;
            },
        statuscode:{	
        	200:function(data){ bootbox.alert({
				title: "Gestión de Tarifas",
				message: "Error en la descarga de tarifas.",
				buttons: {
					ok: {
						label: 'Aceptar',
						className: 'btn btn-primary'
					},
				},
			});
        	//document.getElementById('ficheroImportacion').disabled=true;
        	},
        	404:function(){
        	}
        },
        complete: function(){
			//ocultarPantallaCarga();
		}
    });
}
</script>
